# 1. 네트워크의 큰 그림

## 네트워크 기본 구조

### 네트워크 정의
- 컴퓨터와 통신 장비들이 서로 연결되어 정보를 주고받는 시스템
- 그래프 구조로 모델링 가능한 통신망

### 구성 요소

#### 1. 노드 (Node)
- 정보를 주고받는 장치
- 예시: 컴퓨터, 스마트폰, 라우터 등
- 그래프에서의 정점(Vertex)에 해당

#### 2. 간선 (Link)
- 노드 간 통신을 위한 연결 매체
- 예시: 케이블, Wi-Fi 등
- 그래프에서의 엣지(Edge)에 해당

### 네트워크 토폴로지

#### 1. 망형 (Mesh)
- 모든 노드가 서로 직접 연결
- 장점: 고신뢰성, 고성능
- 단점: 높은 비용

#### 2. 트리형 (Tree)
- 계층적 구조로 구성
- 예시: DNS 시스템
- 장점: 확장성, 관리 용이

#### 3. 링형 (Ring)
- 순환형 구조
- 노드들이 일정 순서로 연결
- 장점: 단순한 구조

#### 4. 성형 (Star)
- 중앙 허브에 각 노드가 연결
- 예시: 일반적인 사무실 LAN
- 장점: 중앙 집중식 관리

#### 5. 버스형 (Bus)
- 하나의 전송선로를 공유
- 장점: 저비용
- 단점: 충돌 위험

### 클라이언트-서버 구조

#### 1. 호스트 (Host)
- 정보를 주고받는 모든 노드
- 클라이언트: 요청(Request)을 보내는 쪽
- 서버: 응답(Response)을 보내는 쪽

#### 2. 동작 예시
- 클라이언트: 노트북이 구글 서버에 웹페이지 요청
- 서버: 구글 서버가 요청된 페이지 응답

### 중간 노드 (네트워크 장비)
- 스위치(Switch), 라우터(Router), 공유기 등
- 역할: 데이터의 올바른 경로 전달 중계
- 별칭: 중간 노드 또는 중계 노드

### LAN과 WAN

#### 1. LAN (Local Area Network)
- **정의**
  - 가정, 회사 등 제한된 지역 안의 네트워크
- **특징**
  - 라우터, 스위치 등을 통해 연결됨
  - 같은 네트워크 안에서는 정보를 자유롭게 교환
  - 주로 사설 IP 사용

#### 2. WAN (Wide Area Network)
- **정의**
  - 여러 LAN을 연결하는 광역 네트워크
- **특징**
  - ISP(Internet Service Provider)가 구축 (예: KT, SKB, LGU+)
  - 전 세계 인터넷 연결을 가능하게 함
  - 공용 IP 사용

### 패킷 교환 네트워크

#### 1. 패킷(Packet)
- **정의**
  - 데이터를 한 번에 전송하지 않고 작은 단위(패킷)로 쪼개어 전송
- **구성 요소**
  - 헤더(header): 출발지/목적지 주소 등 부가 정보
  - 페이로드(payload): 실제 전달하려는 데이터
  - 트레일러(trailer): 에러 검사 등 (옵션)
- **택배 비유**
  - 패킷 = 택배 박스
  - 페이로드 = 내용물
  - 헤더/트레일러 = 송장/주소/검수 스티커

### 주소 개념과 전송 방식

#### 1. 주소
- **IP 주소**
  - 네트워크상의 논리 주소
- **MAC 주소**
  - 물리 주소 (랜카드 고유값)
- **특징**
  - 패킷의 헤더에 명시되어 통신 대상 식별

#### 2. 전송 방식
- **유니캐스트**
  - 1:1 단일 호스트에게 전송
  - 예시: 메일 보내기
- **브로드캐스트**
  - 1:N 모든 호스트에게 전송
  - 예시: ARP 요청
- **멀티캐스트**
  - 1:그룹 특정 호스트 집합에게 전송
  - 예시: IPTV 스트리밍
- **애니캐스트**
  - 1:1(중 가장 가까운 호스트)
  - 예시: CDN 라우팅

#### 3. 브로드캐스트 도메인
- 브로드캐스트가 전달되는 범위
- 일반적으로 하나의 LAN

## 두 호스트가 패킷을 주고받는 과정

네트워크에서 호스트 간 통신 시, 패킷이라는 데이터 단위를 주고받음

이 과정에서 서로를 식별하고 이해하기 위해 프로토콜이라는 규칙이 필요

### 프로토콜

- **정의**
  - 네트워크에서 통신하는 노드 간의 약속된 규칙/방법
  - 예: 패킷의 구조, 순서, 오류 처리 방식 등

- **목적**
  - 패킷이 목적지에 도달할 뿐 아니라, 내용도 정확히 해석되도록 보장

- **대표적인 프로토콜 종류**
  - IP: 주소 지정 (논리 주소)
  - ARP: IP ↔ MAC 주소 변환
  - ICMP: 네트워크 진단 (ex: ping)
  - TCP: 연결 지향, 신뢰성 보장
  - UDP: 비연결, 빠른 전송
  - DHCP: IP 자동 할당
  - DNS: 도메인 ↔ IP 주소 변환
  - HTTP/HTTPS: 웹 통신
  - SSL/TLS: 데이터 암호화 보안 계층

### 프로토콜의 특징

- **목적**
  - 각 프로토콜은 사용 목적이 다름 (예: 주소 지정, 데이터 암호화 등)

- **특징**
  - 같은 목적이라도 신뢰성, 속도, 보안 등에서 차이 발생
  - 예시: TCP는 신뢰성 ↑, UDP는 속도 ↑ / HTTPS는 보안 ↑

- **예시**
  - IP는 "주소를 지정"
  - ARP는 "IP와 MAC 매핑"
  - HTTPS는 "보안 전송"

### 패킷 구조와 헤더 분석

- **TCP 헤더 구조**
  - 송수신 포트: 통신하는 앱 구분
  - 순서 번호: 데이터 순서 재조립
  - 확인 응답 번호: 수신 확인 (ACK)
  - 플래그 비트: 연결 상태 제어 (SYN, FIN 등)
  - 체크섬: 오류 검출

- **UDP 헤더 구조**
  - 송수신 포트: 통신하는 앱 구분
  - 길이: 전체 데이터 길이
  - 체크섬: 오류 검출 (선택적)

- **특징**
  - TCP는 신뢰성을 위해 복잡한 구조를 가짐
  - UDP는 단순하고 빠름

### 네트워크 참조 모델

- **정의**: 호스트 간 패킷 전송 과정을 계층적으로 나눈 구조
- **특징**: 택배 배송처럼 단계적으로 정보가 포장·전달됨
- **목적**: 네트워크 통신 과정의 복잡성을 이해하고 설계, 진단, 문제 해결을 용이하게 함

#### 택배 비유로 보는 계층적 통신 구조
| 단계 | 송신 측 | 수신 측 |
|------|---------|---------|
| 1계층 | 택배 기사에게 택배를 전달 | 택배 기사에게서 택배를 수령 |
| 2계층 | 택배에 주소를 붙임 | 주소를 확인 |
| 3계층 | 택배 상자를 밀봉/개봉 | 밀봉/개봉 |
| 4계층 | 상자에 책을 넣고 뺌 | 책을 꺼냄 |
| 5계층 | 포장지를 제거함 | 포장지를 제거함 |
| 6계층 | 수령 확인 | 수령 확인 |

#### 핵심 개념
- 송신 측: 상위 계층부터 하위 계층으로 정보를 내려보냄
- 수신 측: 하위 계층부터 상위 계층으로 정보를 역순으로 처리

#### 네트워크 계층의 기능
| 계층 | 송신 측 | 수신 측 |
|------|---------|---------|
| 1계층 | 유무선 매체 통해 전송 | 수신 |
| 2계층 | 송수신 MAC 결정 | MAC 확인 |
| 3계층 | IP 주소 결정 및 포워딩 | 라우팅 정보 수신 |
| 4계층 | TCP/UDP 포트 및 흐름제어 | 포트 처리 및 흐름 재구성 |

#### 계층 구조를 사용하는 이유
- 문제 발생 시 원인 추적이 용이
- 계층별 독립적 설계/개발 가능
- 다양한 프로토콜을 조합하여 네트워크 설계

#### 대표적인 네트워크 모델
| 모델 | 설명 |
|------|------|
| OSI 7계층 | 이론 중심, 계층 분리 명확 |
| TCP/IP 4계층 | 실제 인터넷 기반 통신에 사용 |

### OSI 7계층
- **정의**: 국제표준화기구(ISO)에서 제안한 네트워크 참조 모델
- **특징**: 통신 과정을 7단계 계층으로 나눈 모델
- **장점**: 각 계층의 역할 분리로 문제 해결과 네트워크 설계가 용이

#### OSI 7계층 구조
| 계층 | 이름 | 주요 역할 | 대표 프로토콜/기능 |
|------|------|-----------|-------------------|
| 7계층 | 응용 계층 | 사용자에게 네트워크 서비스 제공 | HTTP, HTTPS, DNS |
| 6계층 | 표현 계층 | 데이터 형식, 압축, 인코딩, 암호화 | JPEG, MPEG, SSL |
| 5계층 | 세션 계층 | 세션 관리 (연결 유지, 재연결, 종료) | NetBIOS, RPC |
| 4계층 | 전송 계층 | 신뢰성 있는 전송 보장, 포트 관리 | TCP, UDP |
| 3계층 | 네트워크 계층 | 라우팅, IP 주소 기반 패킷 전달 | IP, ICMP, ARP |
| 2계층 | 데이터 링크 계층 | MAC 주소 기반 노드 식별 및 오류 검출 | 이더넷, 스위치 |
| 1계층 | 물리 계층 | 비트 신호 전송, 물리적 연결 | 케이블, 리피터 |

#### 계층별 핵심 포인트
| 계층 | 핵심 키워드 | 설명 |
|------|------------|------|
| 1 | 비트 전송 | 0과 1 신호를 매체에 실어 전송 |
| 2 | MAC 주소, 프레임 | 오류검출, LAN 내 장치 구분 |
| 3 | IP 주소, 라우팅 | 다른 네트워크로 데이터 전달 |
| 4 | 포트, 세그먼트 | 데이터 전송 제어 (TCP/UDP) |
| 5 | 세션 제어 | 연결 생성·유지·종료 |
| 6 | 인코딩, 압축, 암호화 | 데이터 표현 방식 정의 |
| 7 | 애플리케이션 통신 | 사용자와 가장 가까운 계층 |

#### OSI 계층 모델의 중요성
- **문제 진단 용이성**: 각 계층의 책임이 명확하게 분리되어 있어 문제 발생 시 원인 파악이 쉬움
- **유연한 교체**: 기술, 장비, 프로토콜을 독립적으로 교체 가능
- **학습의 기초**: 실제 TCP/IP 모델은 OSI 7계층에서 일부 통합된 구조이나, OSI 모델은 네트워크 이해와 학습의 기초가 됨

### TCP/IP 모델 (4계층)
인터넷 프로토콜 스택이라고도 하며, 실제 인터넷 구현에 사용되는 실용 중심의 모델이다.

#### 기본 구성
| 계층 | 설명 | 주요 프로토콜 |
|------|------|--------------|
| 응용 계층 | 사용자에게 서비스 제공 | HTTP, FTP, SMTP, DNS |
| 전송 계층 | 통신 흐름 제어, 신뢰성 보장 | TCP, UDP |
| 인터넷 계층 | 경로 설정(라우팅), IP 주소 | IP, ICMP, ARP |
| 네트워크 액세스 계층 | 하드웨어 간 비트 전송 | 이더넷, MAC, 물리 계층 포함 |

#### OSI 모델과 TCP/IP 모델 비교
| OSI 7계층 | TCP/IP 4계층 | 역할 |
|-----------|--------------|------|
| 7. 응용 계층 | | |
| 6. 표현 계층 | 응용 계층 | 사용자 서비스 |
| 5. 세션 계층 | | |
| 4. 전송 계층 | 전송 계층 | TCP, UDP |
| 3. 네트워크 계층 | 인터넷 계층 | IP 주소, 라우팅 |
| 2. 데이터 링크 계층 | | |
| 1. 물리 계층 | 네트워크 액세스 계층 | LAN, 이더넷 등 |

#### 확장된 TCP/IP 모델 (교재 기준)
| 계층 | 대응 OSI 계층 |
|------|--------------|
| 응용 계층 | 5~7계층 |
| 전송 계층 | 4계층 |
| 네트워크 계층 | 3계층 |
| 데이터 링크 계층 | 2계층 |
| 물리 계층 | 1계층 |

# 2. 물리 계층과 데이터 링크 계층

# 이더넷
- **LAN에서 가장 보편적인 유선 네트워크 기술**
- 물리/데이터 링크 계층에 걸쳐 있음
- 전송 방식, 신호 구성, 프레임 형식 규정
- 현대 유선 LAN의 표준 기술

### 이더넷 표준 (IEEE 802.3)
| 표준 | 이름 | 속도 |
|------|------|------|
| IEEE 802.3 | 일반 이더넷 | 10 Mbps |
| IEEE 802.3u | 고속 이더넷 | 100 Mbps |
| IEEE 802.3z | 기가비트 이더넷 | 1 Gbps |
| IEEE 802.3ae | 10기가비트 이더넷 | 10 Gbps |
| IEEE 802.3ba | 100기가비트 이더넷 | 100 Gbps |

### 이더넷 프레임 구조
| 필드 | 크기 | 설명 |
|------|------|------|
| 프리앰블 | 8B | 송수신 동기화 비트열 (10101010...10101011) |
| 수신 MAC | 6B | 수신 장치의 고유 식별자 |
| 송신 MAC | 6B | 송신 장치의 고유 식별자 |
| 타입/길이 | 2B | 1500 이하: 데이터 길이, 1536 이상: 프로토콜 타입 |
| 데이터 | 46~1500B | 상위 계층 데이터 (MTU 기준) |
| FCS | 4B | 오류 검출용 CRC 값 |

### 주요 특징
- **MAC 주소**: 16진수 콜론(:) 구분 (예: ab:cd:ab:cd:00:01)
- **MTU**: 1500바이트 (초과 시 분할)
- 점보 프레임: 1500B 초과 프레임
- 프로토콜 타입: 0800(IPv4), 0806(ARP) 등

### 개발자 주의사항
- IEEE 802.3 표준 준수 확인
- 표준별 호환성 검토
- **최신 장비는 다중 표준 자동 호환**
- "IEEE 802.3x 호환" 표시 확인

## 유무선 통신 매체

### 1. 통신 매체
- **물리/데이터 링크 계층의 하드웨어 기반 데이터 전송 매체**
- **네트워크 속도와 품질에 직접적 영향**
- 호스트 성능과 독립적인 중요 요소

### 2. 유선 매체 - 트위스티드 페어 케이블
#### 개요
- **꼬인 구리선 케이블**
- 컴퓨터, 공유기 등 일반적 연결용

#### 카테고리별 성능
| 카테고리 | 전송 속도 |
|----------|-----------|
| Cat5 | 100 Mbps |
| Cat5e | 1 Gbps |
| Cat6 | 1 Gbps |
| Cat6a | 10 Gbps |
| Cat7 | 10 Gbps |
| Cat8 | **40 Gbps** |

#### 노이즈 차폐 방식
| 방식 | 설명 |
|------|------|
| UTP | 차폐 없음 |
| STP | 쉴딩 있음 |
| FTP | 포일 차폐 |
| S/FTP | **브레이드+포일 혼합** |

- **표기법: [외부 차폐]/[내부 차폐] TP**
- S/FTP: 외부 브레이드, 내부 포일
- F/UTP: 외부 포일, 내부 차폐 없음

### 3. 무선 매체 - Wi-Fi
#### 기본 개념
- **3kHz ~ 3THz 전자기파 통신**
- IEEE 802.11 시리즈 표준

#### Wi-Fi 세대
| 세대 | 표준 |
|------|------|
| Wi-Fi 4 | 802.11n |
| Wi-Fi 5 | 802.11ac |
| Wi-Fi 6 | 802.11ax |
| Wi-Fi 7 | **802.11be** |

### 4. Wi-Fi 주파수와 채널
#### 주파수 대역
| 대역 | 특징 |
|------|------|
| 2.4GHz | **전파 도달거리 길고 간섭 많음** |
| 5GHz | **속도 빠르고 도달거리 짧음** |

#### 채널
- 동일 주파수 대역 내 간섭 방지용 구분
- **2.4GHz 추천 채널: 1, 6, 11번 (비간섭)**
- 5GHz 채널: 36, 40, 44, 48번
- **중첩 채널(1,2,3) 사용 시 간섭으로 성능 저하**

## 네트워크 인터페이스: NIC

### 1. NIC의 정의와 특징
- **네트워크 상에서 노드와 통신 매체를 연결하는 지점**
- **각 NIC마다 고유한 MAC 주소 보유**
- 하드웨어 형태: NIC 카드, LAN 어댑터, USB 네트워크 동글
- **최근에는 메인보드 온보드 내장형 NIC가 일반적**

### 2. NIC의 주요 기능
#### 데이터 변환
- **수신: 패킷 → 호스트 이해 가능한 프레임으로 변환**
- **송신: 패킷 → 전기적 신호로 변환**
- 프레임 전환과 신호 변환 담당

#### 입출력 구조
- 수신 = 입력, 송신 = 출력
- **커널 모드에서 NIC 통신 완료 시 CPU 인터럽트 발생**
- **DMA(직접 메모리 접근) 방식 사용**

### 3. NIC 성능
- **네트워크 속도와 직접 연관**
- **고속 네트워크(10Gbps, 40Gbps) 환경에서는 고성능 NIC 필요**
- 고대역폭 환경에서는 추가 고성능 NIC 장착 가능

### 4. NIC 통합 기술
#### 티밍(Teaming) & 본딩(Bonding)
| 구분 | 특징 |
|------|------|
| Teaming | **Windows 환경, 성능 향상 중심** |
| Bonding | **Linux 환경, 성능 향상 + 장애 복구** |

- **RAID와 유사한 논리적 병렬 처리**
- **NIC 장애 시 트래픽 우회 가능**

## 허브와 스위치

### 1. 허브(Hub)
#### 정의
- **물리 계층(1계층) 장비**
- 여러 대의 호스트를 물리적으로 연결하는 장치

#### 주요 특징
| 항목 | 설명 |
|------|------|
| 전달 방식 | **수신한 신호를 모든 포트로 무작위 전송** |
| 통신 모드 | **반이중(Half-Duplex) - 동시에 송·수신 불가** |
| 충돌 | **충돌(Collision) 발생 가능** |
| 충돌 도메인 | **전체 허브가 1개의 충돌 도메인** |

#### 종류
- 이더넷 허브
- **리피터 허브 (신호 증폭 포함)**

### 2. 스위치(Switch)
#### 정의
- **데이터 링크 계층(2계층) 장비**
- 허브의 기능을 대체하며, 지능적인 전송 지원

#### 주요 특징
| 항목 | 설명 |
|------|------|
| 전달 방식 | **목적지 MAC 주소 기반으로 특정 포트에만 전송** |
| 통신 모드 | **전이중(Full-Duplex) - 동시에 송·수신 가능** |
| 충돌 도메인 | **각 포트마다 별도의 충돌 도메인** |

### 3. MAC 주소 학습 기능
- **스위치는 MAC 주소 학습 기능을 통해 각 포트에 연결된 호스트의 MAC 주소를 자동 저장**
- 저장된 정보는 MAC 주소 테이블에 기록됨
- **이를 기반으로 신호를 목적지 포트로만 전송 가능**

#### MAC 주소 테이블 예시
| 포트 번호 | MAC 주소 |
|-----------|----------|
| 1번 | ab:cd:ab:cd:00:01 |
| 2번 | ab:cd:ab:cd:00:02 |
| ... | ... |

### 4. VLAN (Virtual LAN)
- **논리적으로 LAN을 분할하는 기능**
- **같은 스위치에 연결된 포트라 하더라도, 서로 다른 VLAN에 속하면 브로드캐스트 메시지가 전달되지 않음**

#### VLAN 활용 예시
- 호스트 A~D: VLAN 1
- 호스트 E~F: VLAN 2
  - **서로 통신 불가, 라우터 등 상위 계층 장비 필요**

# 3. 네트워크 계층 - IP

## IP의 목적과 특징

### 1. IP의 목적과 특징
#### 목적
- **주소 지정(Addressing)**
  - IP 주소를 통해 송신자와 수신자 식별
- **단편화(Fragmentation)**
  - 큰 데이터를 여러 IP 패킷으로 쪼개어 전송

#### 특징
- **신뢰할 수 없는 통신(Unreliable)**: 전달 보장 없음 (TCP가 신뢰성 제공)
- **비연결형(Connectionless)**: 세션 없이 패킷 단위 전송
- **최선형 전달(Best Effort)**: 실패해도 재전송 없음, 확인 절차 없음

### 2. IP 주소 구조
| 구분 | 설명 |
|------|------|
| IPv4 주소 | **32비트 (4바이트)**, 예: 192.168.0.1 (8비트씩 점으로 구분된 10진수) |
| IPv6 주소 | **128비트 (16바이트)**, 예: 2001:0230:abcd:ffff:0000:0000:ffff:1111 (16진수 8블록, 콜론으로 구분) |

- IPv4 주소 수량: **약 43억 개**
- IPv6 주소 수량: **2¹²⁸개**

### 3. IP 패킷 구조
#### IPv4 헤더 구조 (주요 필드)
| 필드명 | 설명 |
|--------|------|
| 버전 | IP 버전 (4 또는 6) |
| 헤더 길이 | 고정 or 가변 길이 |
| TTL | **생존 시간 (Time To Live)** |
| 프로토콜 | **상위 프로토콜 식별** (예: TCP=6, UDP=17) |
| 송/수신자 IP 주소 | 목적지와 출발지 주소 |
| 식별자 | **단편화된 패킷을 재조립할 때 동일한 그룹으로 묶음** |
| 플래그 | **DF(Don't Fragment), MF(More Fragment)** |
| 단편화 오프셋 | **단편 중 몇 번째인지 명시** |

### 4. IP 단편화
#### 개념
- **MTU(Maximum Transmission Unit)**를 초과하는 데이터는 쪼개서 전송
- 수신자는 **식별자 + 오프셋** 기반으로 재조립

#### 경로 MTU(Path MTU) 발견
- 송신 전 경로에 있는 모든 장비의 MTU 중 **가장 작은 값** 사용
- 이를 통해 단편화를 최소화하거나 피할 수 있음

### 5. IP 헤더 단편화 관련 필드
| 필드명 | 설명 |
|--------|------|
| 식별자(Identifier) | **단편화된 조각들이 같은 패킷이라는 걸 식별** |
| 플래그(Flag) | **DF = 단편화 금지, MF = 추가 조각 있음** |
| 단편화 오프셋 | **단편 위치 지정, 재조립 시 사용** |

### 6. 신뢰성 및 연결성 관련 특성
| 특성 | 설명 |
|------|------|
| 신뢰할 수 없음 | **전달 성공 보장 없음** (→ TCP로 보완) |
| 비연결형 | **송수신자 간 연결 설정 없이 통신 시작** |
| 최선형 전달 | **실패에 대한 대응 없이 가능한 한 전송만 수행** |

### 7. 예시 패킷 분석 (wireshark)
```
- Source: 10.0.0.1
- Destination: 10.0.0.2
- Identification: 0x2c2e
- Fragment Offset: 0
- Flags: More Fragments (MF)
```
이후 등장하는 또 다른 패킷:
```
- Identification: 0x2c2e
- Fragment Offset: 1480
```
→ 1500 바이트를 초과한 데이터가 IP 단편화되어 전송된 예시

## IP 주소의 구조

### 1. IP 주소 기본 구조
- **32비트(4바이트)** 로 구성, 8비트 단위로 구분 (예: 172.16.12.45)
- **네트워크 주소 + 호스트 주소**로 구성
  - 네트워크 주소: **소속 네트워크 식별**
  - 호스트 주소: **해당 네트워크 내 개별 장치 식별**

### 2. IP 주소 표현
- **10진수**: 172.16.12.45
- **2진수**: 10101100.00010000.00001100.00101101

### 3. 네트워크/호스트 분리 방식
| 구분 | 네트워크 주소 | 호스트 주소 |
|------|--------------|------------|
| (a) | 8비트 | 24비트 |
| (b) | 16비트 | 16비트 |
| (c) | 24비트 | 8비트 |

### 4. 클래스풀 주소 체계
| 클래스 | 시작 비트 | 네트워크 비트 | 호스트 비트 | 주소 범위 |
|--------|-----------|--------------|------------|-----------|
| A | 0 | 8비트 | 24비트 | 0.0.0.0 ~ 127.255.255.255 |
| B | 10 | 16비트 | 16비트 | 128.0.0.0 ~ 191.255.255.255 |
| C | 110 | 24비트 | 8비트 | 192.0.0.0 ~ 223.255.255.255 |

> D, E 클래스: 멀티캐스트 및 실험용

### 5. 특수 IP 주소
#### 네트워크/브로드캐스트 주소
- **네트워크 주소**: 호스트 비트가 모두 0 (예: 172.16.0.0)
- **브로드캐스트 주소**: 호스트 비트가 모두 1 (예: 172.16.255.255)

#### 예약 주소
| 주소 범위 | 용도 |
|-----------|------|
| 0.0.0.0 ~ 0.255.255.255 | 현재 네트워크 |
| 127.0.0.0 ~ 127.255.255.255 | 루프백(loopback) 주소 |
| 10.0.0.0 ~ 10.255.255.255 | 사설 IP |
| 192.168.0.0 ~ 192.168.255.255 | 사설 IP |

### 6. 클래스리스 주소 체계
#### 서브넷 마스크
- **비트 마스크**로 네트워크/호스트 구분
- **비트 AND 연산**으로 네트워크 주소 추출

예시:
```
IP: 192.168.200.102
서브넷 마스크: 255.255.255.0
네트워크 주소: 192.168.200.0
```

### 7. 기본 서브넷 마스크
| 클래스 | 서브넷 마스크 | 비트 표현 |
|--------|--------------|-----------|
| A | 255.0.0.0 | 11111111.00000000.00000000.00000000 |
| B | 255.255.0.0 | 11111111.11111111.00000000.00000000 |
| C | 255.255.255.0 | 11111111.11111111.11111111.00000000 |

### 8. CIDR 표기법
| 구분 | 설명 |
|------|------|
| **CIDR** | Classless Inter-Domain Routing의 약자 |
| **표기법** | IP 주소와 서브넷 마스크를 / 표기로 표현 |

#### 예시
IP 주소: 192.168.0.3/30
- 서브넷 마스크: 255.255.255.252
- 의미: 상위 30비트가 1인 서브넷 마스크
- 이진수: 11111111.11111111.11111111.11111100

# 공인 IP 주소와 사설 IP 주소

## 1. 공인 IP 주소 (Public IP Address)
### 정의
> 전 세계적으로 고유한 IP 주소로, 인터넷에서 직접 통신 가능한 주소

### 특징
- **인터넷 서비스 제공자(ISP)에게 할당받음**
- **공개 네트워크에 사용됨**
- **다른 네트워크에서도 유일해야 함**
- IP 조회 사이트(예: 구글에서 "What is my IP")에서 표시되는 IP 주소가 공인 IP임

### 사용 예시
- 서버
- 클라우드 인스턴스
- 공유기 WAN 포트

## 2. 사설 IP 주소 (Private IP Address)
### 정의
> 사설 네트워크 내부에서만 사용되는 IP 주소. 외부 인터넷에서는 인식되지 않음

### 특징
- **공인 IP 절약 및 내부망 구성에 사용**
- 일반적으로 **공유기(LAN)**에 연결된 기기들이 이 IP를 가짐
- **동일한 사설 IP를 다른 네트워크에서도 중복 사용 가능** (충돌 없음)
- 인터넷으로 나갈 땐 **NAT(Network Address Translation)**으로 공인 IP로 변환됨

### 사설 IP 대역 (RFC1918)
| 대역 | CIDR |
|------|------|
| 10.0.0.0 ~ 10.255.255.255 | 10.0.0.0/8 |
| 172.16.0.0 ~ 172.31.255.255 | 172.16.0.0/12 |
| 192.168.0.0 ~ 192.168.255.255 | 192.168.0.0/16 |

## 3. IP 확인 방법
### 운영체제별 명령어
| OS | 명령어 | 예시 |
|----|--------|------|
| Windows | `ipconfig /all` | IPv4 주소: 192.168.0.19 (사설 IP) |
| MacOS/Linux | `ifconfig` | inet 10.16.191.72 (사설 IP) |
| 브라우저 | "What is my IP" 검색 | 163.152.3.171 (공인 IP) |

## 4. NAT (Network Address Translation)
### 정의
> 사설 IP 주소를 공인 IP 주소로 변환하는 기술

### 동작 방식
1. 내부 네트워크의 사설 IP를 공유기에서 공인 IP로 변환
2. 변환된 공인 IP로 외부 인터넷과 통신
3. 응답은 다시 공유기를 통해 원래의 사설 IP로 전달

### 특징
- **사설 IP는 인터넷에서 직접 사용 불가**
- **다른 네트워크에서 동일한 사설 IP 사용 가능** (충돌 없음)
- **공인 IP는 ISP에서 유료로 할당** (중복 불가)

## IP 주소 할당 방식

### 개요
IP 주소 할당 방식은 크게 두 가지로 구분됩니다:
- **정적 할당 (Static IP)**: 수동으로 고정 IP 부여
- **동적 할당 (Dynamic IP)**: DHCP 프로토콜로 자동 할당

### 1. 정적 할당 (Static IP Address)

#### 정의
- 사용자가 직접 IP 주소를 수동으로 설정
- 항상 고정된 IP 사용
- 운영체제 설정 메뉴에서 직접 입력 필요

#### 구성 요소
| 구성 요소 | 설명 |
|----------|------|
| IP 주소 | 호스트의 고유 주소 |
| 서브넷 마스크 | 네트워크 범위 지정 |
| 기본 게이트웨이 | 외부 네트워크 통신 출구 (보통 공유기 주소) |
| DNS 서버 주소 | 도메인명 → IP 변환 서버 (예: 8.8.8.8, 1.1.1.1) |

#### 특징
- 네트워크 관리자 통제 가능
- 서버, 프린터, CCTV 등 고정 장비에 적합
- 주소 충돌 가능성 존재

### 2. 동적 할당 (DHCP)

#### 정의
- DHCP 서버가 IP 주소를 자동으로 할당
- 사용자 설정 불필요

#### 특징
- IP 주소 풀에서 자동 임대
- **임대 기간(Lease Time)** 존재
- IP 주소 변경 가능
- 일반 PC, 모바일, IoT 기기용

#### 구성 흐름
1. 클라이언트 → DHCP 서버 요청
2. 서버 → IP, 서브넷, 게이트웨이, DNS 포함 임대 제안
3. 클라이언트 수락 → 임대 계약
4. 임대 기간 만료 시 갱신/반납

#### 장점
- 자동 관리
- IP 자원 효율적 사용
- 주소 중복 방지

#### 정적 vs 동적 할당 비교

| 항목 | 정적 할당 | 동적 할당 |
|------|-----------|-----------|
| 설정 방식 | 수동 입력 | 자동 할당 |
| 주소 변경 | 없음 | 있음 |
| 사용 예시 | 서버, 프린터, NAS | PC, 스마트폰, 노트북 |
| 구성 요소 | 직접 설정 | 자동 제공 |
| 관리 편의성 | 낮음 | 높음 |

## IP 전송 특징의 보완: ICMP

### 1. ICMP 개요
#### 📌 ICMP란?
- IP 프로토콜의 **오류 처리 및 제어 메시지용** 프로토콜
- 비신뢰성 비연결형 IP 전송의 한계를 보완하기 위한 **보조 수단**
- IP 패킷 전송 중 발생한 문제를 송신자에게 알림

### 2. ICMP의 주요 역할
| 분류 | 메시지 종류 |
|------|------------|
| **오류 보고** | • 네트워크 도달 불가<br>• 호스트 도달 불가<br>• 프로토콜 도달 불가<br>• 포트 도달 불가<br>• 단편화 필요하지만 DF 설정됨<br>• TTL 만료 |
| **네트워크 정보 제공** | • Echo 요청 (Ping 요청)<br>• Echo 응답 (Ping 응답) |

### 3. TTL(Time To Live) 관련 ICMP 메시지
- IP 헤더의 TTL은 패킷이 네트워크를 몇 개의 라우터를 거칠 수 있는지를 **제한**
- TTL이 1씩 줄어들다 0이 되면 "**시간 초과(Time Exceeded)**" ICMP 메시지 발생
- **무한 루프 방지**를 위한 메커니즘

### 4. 단편화 오류 예시
- 큰 패킷을 전달해야 할 때, 네트워크 장비가 **분할 전송**을 시도
- DF(Don't Fragment) 플래그가 설정되어 있으면 분할 불가 → **ICMP 오류 전송**

### 5. ICMP 기반 네트워크 진단 도구

#### ping 명령어
- **기능**: 호스트 연결성 및 응답 시간 테스트
- **동작 방식**: 
  - Echo Request 패킷 전송
  - Echo Reply 수신으로 RTT(Round Trip Time) 측정
- **사용 예시**: `ping google.com`

#### traceroute/tracert 명령어
- **기능**: 네트워크 경로 추적
- **동작 방식**:
  - TTL 값을 1부터 순차적으로 증가
  - 각 홉에서 ICMP "시간 초과" 메시지 수신
  - 응답 시간과 라우터 IP 주소 기록
- **사용 예시**: `traceroute google.com`

### 주의사항
- ICMP는 신뢰성 보장 프로토콜이 아님
- 실제 데이터 전송의 신뢰성은 TCP가 담당
- 보안 정책에 따라 ICMP 차단 시 진단 도구 사용 불가

## IP 주소와 MAC 주소의 대응: ARP

### 1. ARP 개요
#### 📌 ARP (주소 결정 프로토콜)란?
- **IP 주소 → MAC 주소** 변환을 위한 프로토콜
- 동일 네트워크 내에서 통신 대상의 MAC 주소를 모를 때 사용
- **IP 주소를 기반으로 MAC 주소를 알아내는** 메커니즘

### 2. ARP의 필요성
| 구분 | IP 주소 | MAC 주소 |
|------|---------|----------|
| **계층** | 계층 3 (네트워크) | 계층 2 (데이터 링크) |
| **특성** | 논리적 주소 | 물리적 주소 |
| **용도** | 목적지 식별 | 실제 프레임 전송 |

### 3. ARP 동작 원리
1. **요청 단계**
   - 호스트 A가 호스트 B의 IP는 알고 있으나 MAC은 모름
   - **브로드캐스트**로 "이 IP를 가진 장치의 MAC 주소가 뭐야?" 메시지 전송

2. **응답 단계**
   - 호스트 B가 자기 IP와 일치하는 메시지 수신
   - **유니캐스트**로 자신의 MAC 주소 회신
   - 호스트 A는 응답받은 MAC 주소로 통신 가능

### 4. ARP 메시지 종류
| 메시지 종류 | 설명 | 전송 방식 |
|------------|------|-----------|
| **ARP 요청** | "이 IP에 해당하는 MAC 누구냐?" | 브로드캐스트 |
| **ARP 응답** | "나야! 내 MAC은 이거야" | 유니캐스트 |

### 5. ARP 테이블
- **정의**: IP ↔ MAC 주소 매핑 정보를 저장하는 캐시 테이블
- **특징**:
  - 한 번 응답받은 MAC 주소는 테이블에 저장
  - 성능 향상 및 중복 요청 방지
  - 일정 시간 후 자동/수동 삭제 가능
- **확인 명령어**: `arp -a` (윈도우 CMD)


# 4. 전송 계층 - TCP와 UDP

## TCP와 UDP의 목적과 특징

### 1. 전송 계층의 목적
- **호스트 내 프로세스 식별**을 위한 계층
- **IP 주소 + 포트 번호** 조합으로 식별
  - 예시: `192.168.0.15:8000`

### 2. TCP vs UDP 비교
| 특성 | TCP | UDP |
|------|-----|-----|
| **연결 방식** | 연결 지향 | 비연결 지향 |
| **신뢰성** | ⭕ 데이터 보장 | ❌ 데이터 미보장 |
| **흐름 제어** | ⭕ | ❌ |
| **오류 제어** | ⭕ | ❌ |
| **속도** | 느림 | 빠름 |
| **주요 용도** | 웹, 이메일, 파일 전송 | DNS, 스트리밍, VoIP, 게임 |

### 3. 포트 번호 체계
- **16비트 정수** (0~65535, 총 65,536개)

| 구분 | 범위 | 주요 예시 |
|------|------|-----------|
| **잘 알려진 포트** | 0~1023 | 80(HTTP), 443(HTTPS), 53(DNS) |
| **등록된 포트** | 1024~49151 | 3306(MySQL), 1433(MSSQL) |
| **동적/사설 포트** | 49152~65535 | 클라이언트 임시 사용 |

### 4. 프로토콜 헤더 비교
#### UDP 헤더 (간단)
- 송신지 포트
- 수신지 포트
- 길이
- 체크섬

#### TCP 헤더 (복잡)
- 송신지/수신지 포트
- 순서 번호 (Sequence Number)
- 확인 응답 번호 (Ack Number)
- 제어 비트 (SYN, ACK, FIN)
- 윈도우 크기
- 체크섬

### 5. TCP 신뢰성 보장 요소
- **순서 번호**: 데이터 바이트 위치 식별
- **확인 응답 번호**: 다음 수신 예정 바이트 번호
- **제어 비트**:
  - `SYN`: 연결 시작
  - `ACK`: 수신 확인
  - `FIN`: 연결 종료

### 6. NAT vs NAPT
| 구분 | NAT | NAPT |
|------|-----|------|
| **기능** | IP 주소 변환 | IP+포트 변환 |
| **용도** | 공인 IP 절약 | 다수 기기 인터넷 사용 |
| **예시** | 192.168.0.5 → 1.2.3.4 | 192.168.0.5:1025 → 1.2.3.4:62001 |

### 7. 포트 사용 예시
- **서버**: 고정 포트 (예: HTTP 80)
- **클라이언트**: 동적 포트 (49152~65535)

## TCP의 연결부터 종료까지

### 1. TCP 연결 수립 (Three-Way Handshake)
> TCP는 연결 지향 프로토콜로, 신뢰성 있는 데이터 전송을 위해 먼저 연결을 설정합니다.

#### 핸드셰이크 과정
| 단계 | 송신 → 수신 | 설명 |
|------|------------|------|
| STEP 1 | A → B : SYN | • 호스트 A가 연결 요청<br>• 시퀀스 번호 설정 (예: seq = 100) |
| STEP 2 | B → A : SYN + ACK | • B가 요청 수락<br>• 자신의 시퀀스 번호 설정 (예: seq = 300)<br>• A의 시퀀스 응답 (ack = 101) |
| STEP 3 | A → B : ACK | • A가 B의 시퀀스 확인 (ack = 301)<br>• 양방향 통신 시작 |

### 2. TCP의 신뢰성 기능
> TCP는 데이터의 유실, 손상, 순서를 보장하기 위한 3가지 제어 기능을 제공합니다.

#### 2-1. 오류 제어 (Error Control)
- **ACK 기반**: 데이터 전송 후 ACK 수신 시 성공
- **Timeout 재전송**: ACK 미수신 시 재전송
- **중복 ACK 감지**: 동일 ACK 3회 수신 시 Fast Retransmit

#### 2-2. 흐름 제어 (Flow Control)
- **슬라이딩 윈도우** 방식 사용
- 수신자의 버퍼 크기에 맞춰 전송량 조절
- 버퍼 오버플로우 방지

#### 2-3. 혼잡 제어 (Congestion Control)
| 알고리즘 | 설명 |
|----------|------|
| Slow Start | 전송량 지수적 증가 |
| Congestion Avoidance | 임계점 이후 선형 증가 |
| Fast Retransmit | 중복 ACK 3회 시 재전송 |
| Fast Recovery | 패킷 손실 후 윈도우 크기 조정 |

### 3. TCP 연결 종료 (Four-Way Handshake)
> 양방향 통신의 완전한 종료를 위해 4단계 절차를 수행합니다.

#### 종료 과정
| 단계 | 송신 → 수신 | 설명 |
|------|------------|------|
| STEP 1 | A → B : FIN | A의 연결 종료 요청 |
| STEP 2 | B → A : ACK | B의 종료 요청 수락 |
| STEP 3 | B → A : FIN | B의 연결 종료 요청 |
| STEP 4 | A → B : ACK | A의 종료 요청 수락 |

#### TIME_WAIT 상태
- **지속 시간**: 2MSL (Maximum Segment Lifetime)
- **목적**:
  1. 지연된 패킷 처리
  2. 마지막 ACK 손실 대비

## TCP의 상태 관리

### 1️⃣ 연결 수립 전 상태
> TCP 연결이 시작되기 전의 초기 상태들입니다.

| 상태 | 설명 |
|------|------|
| **CLOSED** | • 기본 상태<br>• 연결이 존재하지 않음<br>• 초기 상태 또는 종료 후 상태 |
| **LISTEN** | • 수신 대기 상태<br>• 서버가 클라이언트의 연결 요청(SYN)을 기다림<br>• 수동 오픈 상태 |

#### 주요 흐름 예시
| 단계 | 설명 |
|------|------|
| 서버 | bind() 후 listen() 호출 → LISTEN 상태 진입 |
| 클라이언트 | 연결 요청 전까지 CLOSED 상태 유지 |

### 2️⃣ 연결 수립 과정의 주요 상태
> TCP는 3-Way Handshake를 통해 연결을 수립하며, 이 과정에서 다양한 상태가 전이됩니다.

| 상태 | 설명 |
|------|------|
| **SYN_SENT** | • 클라이언트의 연결 요청(SYN) 전송 후 대기<br>• 능동 오픈 상태 |
| **SYN_RECEIVED** | • 서버가 클라이언트의 SYN 수신 후 SYN+ACK 전송<br>• 수동 오픈 상태 |
| **ESTABLISHED** | • 3-Way Handshake 완료<br>• 양방향 데이터 전송 가능 |

#### 상태 전이 흐름
**클라이언트 측**
1. CLOSED → SYN_SENT (SYN 전송)
2. SYN_SENT → ESTABLISHED (SYN+ACK 수신 후 ACK 전송)

**서버 측**
1. LISTEN → SYN_RECEIVED (SYN 수신 후 SYN+ACK 전송)
2. SYN_RECEIVED → ESTABLISHED (ACK 수신)

### 3️⃣ 연결 종료 과정의 주요 상태
> TCP는 4-Way Handshake 방식으로 연결을 종료하며, 종료 시에도 여러 상태를 거칩니다.

| 상태 | 설명 |
|------|------|
| **FIN_WAIT_1** | • FIN 전송 후 ACK/FIN+ACK 대기 |
| **FIN_WAIT_2** | • 상대방의 FIN 전송 대기 (ACK 수신 완료) |
| **CLOSE_WAIT** | • 상대방의 FIN 수신 후 내 FIN 미전송 상태 |
| **LAST_ACK** | • 내 FIN 전송 후 상대방의 ACK 대기 |
| **TIME_WAIT** | • 종료 절차 완료 후 대기 (재전송 대비) |
| **CLOSING** | • 동시 FIN 교환 시 발생하는 희귀 상태 |

#### 양측 종료 흐름
**클라이언트 종료 (먼저 종료)**
1. ESTABLISHED → FIN_WAIT_1 (FIN 전송)
2. FIN_WAIT_1 → FIN_WAIT_2 (ACK 수신)
3. FIN_WAIT_2 → TIME_WAIT (FIN 수신 후 ACK 전송)
4. TIME_WAIT → CLOSED (2MSL 후 종료)

**서버 종료 (상대 FIN 수신)**
1. ESTABLISHED → CLOSE_WAIT (FIN 수신, ACK 전송)
2. CLOSE_WAIT → LAST_ACK (내 FIN 전송)
3. LAST_ACK → CLOSED (ACK 수신)

#### TCP 상태 전이 다이어그램
```
CLOSED
  ↑      ↘
  |       ↘
LISTEN   SYN_SENT
   ↓         ↓
SYN_RECEIVED   → ESTABLISHED ←
     ↓                     ↓
  FIN_WAIT_1         CLOSE_WAIT
     ↓                     ↓
  FIN_WAIT_2         LAST_ACK
     ↓                     ↓
  TIME_WAIT ← CLOSING ←
          ↓
        CLOSED
```

#### 부가 설명
- TIME_WAIT의 역할: 마지막 ACK가 손실될 경우 재전송 대비
- CLOSE_WAIT의 흔한 문제: 애플리케이션이 FIN을 보내지 않아 세션이 닫히지 않음 → 리소스 낭비 가능
